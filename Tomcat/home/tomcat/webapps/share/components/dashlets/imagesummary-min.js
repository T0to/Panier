(function(){var b=YAHOO.util.Event,d=YAHOO.util.Dom;var a=Alfresco.util.encodeHTML;Alfresco.dashlet.ImageSummary=function e(g){Alfresco.dashlet.ImageSummary.superclass.constructor.call(this,"Alfresco.dashlet.ImageSummary",g);b.addListener(window,"resize",this.resizeThumbnailList,this,true);return this};YAHOO.extend(Alfresco.dashlet.ImageSummary,Alfresco.component.Base,{itemsPerRow:0,itemPadding:"0.0",onReady:function f(){Alfresco.util.Ajax.jsonRequest({url:Alfresco.constants.PROXY_URI+"slingshot/doclib/images/site/"+this.options.siteId+"/documentLibrary?max=250",successCallback:{fn:function(k){var g=d.get(this.id+"-images"),q=d.get(this.id+"-item-template"),n=k.json.items;var p=unescape(q.innerHTML);for(var m=0,l=n.length,o,r;m<l;m++){r=n[m];var h={nodeRef:r.nodeRef,nodeRefUrl:r.nodeRef.replace(":/",""),name:encodeURIComponent(r.name),title:a(r.title),modifier:this.msg("text.modified-by",a(r.modifier)),modified:Alfresco.util.formatDate(Alfresco.util.fromISO8601(r.modifiedOn))};o=q.cloneNode(true);o.innerHTML=YAHOO.lang.substitute(p,h);g.appendChild(o)}d.addClass(this.id+"-wait","hidden");this.resizeThumbnailList(null);d.removeClass(g,"hidden")},scope:this},failureCallback:{fn:function(g){d.addClass(this.id+"-wait","hidden");var h=d.get(this.id+"-message");h.innerHTML=a(g.json.message);d.removeClass(h,"hidden")},scope:this}})},resizeThumbnailList:function c(m){var p=d.get(this.id+"-list"),q=p.clientWidth-16-(m?0:16),l=Math.floor(q/110),o=(((q%110)/l/2)+3.5).toFixed(1);if(l===0){l=1}if(l!==this.itemsPerRow||o!==this.itemPadding){var n=d.getElementsByClassName("item",null,p);for(var k=0,h=n.length,g="0 "+o+"px 8px";k<h;k++){if(o!==this.itemPadding){d.setStyle(n[k],"padding",g)}if(l!==this.itemsPerRow){if(k%l===0){d.addClass(n[k],"initial")}else{d.removeClass(n[k],"initial")}}}this.itemPadding=o;this.itemsPerRow=l}}})})();